# 类鸟群（Boids）算法

## 基本介绍

> $1986$ 年，Craig Reynolds 创造鸟类群体行为的一种逼真模拟，称为 `类鸟群（Boids）` 模型。—— [美]Mahesh Venkitachalam 的 *《Python极客项目编程》*
> 
> Craig Reynolds 中文名 克雷格·雷诺兹，其于 $1987$ 年发表类鸟群算法论文。

> [!NOTE]
> 此算法同样适用于鱼群、虫群、舰队群等，类鸟群算法在游戏和电影中都有着广泛的应用。

## 算法原理

中心化思想即在集群中选出或创建一个特殊的个体作为“老大”，同集群的个体都跟着它，但是这样不容易避障，且极为生硬。类鸟群算法运用了**去中心化**思想，仅关心个体，集群是其外观上的表现。

此算法仅使用 $3$ **个核心规则** 模拟鸟类群：
1. **分离**：个体避开拥挤处，即保持个体之间的最小距离
2. **列队**（对齐）：个体朝着周围同伴的平均移动方向前进
3. **内聚**（聚集）：个体朝着周围同伴的平均位置（中心）移动。

之后，我们要应用所有**附加规则、边界条件**。以固定频率（类似 $GameTick$，即游戏刻）更新类鸟个体的位置和速度，并在场景中渲染它们，应用模型的动画、位置和Y轴旋转。
- 我们可以为类鸟群实现**避障**功能，当个体处于障碍物的半径 $R$ 内时，将其视为个体能够看见障碍物，并避开它的距离。
- 对类鸟群施加**大风**，类鸟群应该暂时被风吹（对所有个体施加对应随机方向的力），风停止后回到群聚状态。
- 让鸟在一定时间后到**地面休息**一段时间，到地面时同样要像现实中的鸟一样，受到惊吓时飞走，利用寻路算法找到食物、聚集栖息、打斗（仅部分种类的鸟）等。

> [!TIP]
> 在大多数情况下，不需要太多个体。如果需要很多个体实现十分壮观的场面，需要着重对性能进行优化，考虑LOD、减少模型三角面等。
> 
> 每个个体应该有刚体组件模拟物理效果，但如果要实现鸟群，那么应该在飞行过程中持续对鸟施加向上的力，你也可以锁定鸟的 $y$ 轴坐标，但不推荐，因为鸟总要到地上休息的吧。
> 
> 不建议直接设置坐标，可以对个体施加力，防止意料之外的结果。（但这会降低性能，请考虑平衡性）

## 参考资料与友情链接

- [【游戏开发秘籍】用算法让NPC集体“开窍”？Boids鸟群算法详解！——Voidmatrix](https://www.bilibili.com/video/BV1XgM1zQEF5)
- [美]Mahesh Venkitachalam 的 *《Python极客项目编程》*（ISBN：`978-7-115-44976-4`）